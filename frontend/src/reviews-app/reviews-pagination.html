<link rel="import" href="../../bower_components/polymer/polymer.html">


<!--
`<pagination>` injects a ability for creating pagination into your page.

In typical use, just slap some `<new-review>` at your body:

    <body>
      <new-review url="`url`"></new-review>
-->

<dom-module id="reviews-pagination">
  <style>
    ul {
      clear:both;
      list-style: none;
      display: block;
      text-align: center;
      padding: 20px;
    }
    li {
      list-style: none;
      display: inline;
      padding: 0px 5px;
    }
    a {
      text-decoration: none;
      color: #777;
    }
    span {
      color: #ccc; 
    }
    li span {
      display: none;
    }
    li.disabled span {
      display: inline;
    }
    li.disabled a {
      display: none;
    }
    ul li span.active {
      color: #777;
      display: inline;
    }
  </style>
  <template>
    <ul id="_pagination">
      <li id="first_page">
        <a href="#" id="first_page_link" page=""><<</a>
        <span id="first_page_text"><<</span>
      </li>
      <li id="prev_page">
        <a href="#" id="prev_page_link" page=""><</a>
        <span id="prev_page_text"><</span>
      </li>
      <li><span id="current_page_text" class="active"></span></li>
      <li id="next_page">
        <a href="#" id="next_page_link" page="">></a>
        <span id="next_page_text">></span>
      </li>
      <li id="last_page">
        <a href="#" id="last_page_link" page="">>></a>
        <span id="last_page_text">>></span>
      </li>
    </ul>
  </template>
  <script>
    /**
       * Fired when geeting `data` from backend server. Using for add out listeners
       *
       * @event success
    */
    Polymer({
      is: "reviews-pagination",
      properties: {
        /** Url for getting data. */
        url: String,
        current_page: Number,
        page_count: Number
      },
      ready: function(){
        var self = this;
        Polymer.dom(this.root).querySelectorAll('#_pagination a').forEach(function(item){
          item.addEventListener('click', self._click.bind(self));
        });
      },
      /**
       * method calls when need generate link of pagination.
       *
       * @method generate
       */
      generate: function(){
        if (this.current_page>1){
          this.$.first_page_link.setAttribute('page',1);
          this.$.first_page.classList.remove('disabled');
          this.$.prev_page_link.setAttribute('page',this.current_page-1);
          this.$.prev_page.classList.remove('disabled');
        }else{
          this.$.first_page.classList.add('disabled');
          this.$.prev_page.classList.add('disabled');
        }
        
        this.$.current_page_text.textContent = this.current_page;

        if (this.current_page<this.page_count) {
          this.$.next_page_link.setAttribute('page',this.current_page+1);
          this.$.next_page.classList.remove('disabled');
          this.$.last_page_link.setAttribute('page',this.page_count);
          this.$.last_page.classList.remove('disabled');
        }else{
          this.$.next_page.classList.add('disabled');
          this.$.last_page.classList.add('disabled');
        }

        if (this.page_count==1)
          this.$._pagination.style.display = 'none';
        else
          this.$._pagination.style.display = 'block';
      },
      /**
       * Listener for click event of pagination link
       * 
       * @listener  `pagination link` click
      */
      _click: function(e){ 
        e.preventDefault(); 
        this.current_page = e.target.getAttribute('page'); 
        this.fire('clicklink');          
      }
    });
  </script>
</dom-module>